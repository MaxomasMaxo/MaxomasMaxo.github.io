<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Informes Power BI - Teams</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
            font-family: Segoe UI, wf_segoe-ui_normal, helvetica, arial, sans-serif;
            background-color: #f5f5f5;
        }
        .powerbi-container {
            width: 100%;
            height: calc(100vh - 90px); /* Ajusta según el alto de tu header+botonera */
            border: none;
            display: block;
        }
        .header {
            background-color: #6264A7;
            color: white;
            padding: 10px 20px;
            text-align: center;
            font-size: 1.2em;
            height: 50px;
            box-sizing: border-box;
        }
        .botonera {
            text-align: center;
            margin: 10px 0;
            height: 40px;
        }
    </style>
</head>
<body>

    <div class="header">
        Informes Power BI - Teams
    </div>
    <div class="botonera">
        <button onclick="goToPage('Filtros')">Filtros</button>
        <button onclick="goToPage('ResumenClientes')">Resumen Clientes</button>
        <button onclick="goToPage('CUporhora')">CU por hora</button>
        <button onclick="goFullScreen()">Pantalla completa</button>
    </div>

    <iframe
        id="powerbiFrame"
        title="Informe Power BI Ejemplo"
        class="powerbi-container"
        src="https://app.powerbi.com/reportEmbed?reportId=1ebb6e5b-e4f6-4e6d-ac91-329c65574ceb&autoAuth=true&ctid=012f520d-f6ca-493e-ad55-86ec0bec16c0&pageName=ReportSection"
        frameborder="0"
        allowFullScreen="true">
    </iframe>

    <script>
        const pages = ['Filtros', 'Resumen_Clientes', 'CU_por_hora'];
        let currentPage = 0;
        let timer = null;

        function goToPage(pageName) {
            const baseUrl = "https://app.powerbi.com/reportEmbed?reportId=1ebb6e5b-e4f6-4e6d-ac91-329c65574ceb&autoAuth=true&ctid=012f520d-f6ca-493e-ad55-86ec0bec16c0";
            document.getElementById('powerbiFrame').src = baseUrl + "&pageName=" + pageName;
        }

        function goFullScreen() {
            const iframe = document.getElementById('powerbiFrame');
            if (iframe.requestFullscreen) {
                iframe.requestFullscreen();
            } else if (iframe.mozRequestFullScreen) {
                iframe.mozRequestFullScreen();
            } else if (iframe.webkitRequestFullscreen) {
                iframe.webkitRequestFullscreen();
            } else if (iframe.msRequestFullscreen) {
                iframe.msRequestFullscreen();
            }
        }

        function startAutoRotate(intervalMs = 45000) {
            if (timer) clearInterval(timer);
            timer = setInterval(() => {
                currentPage = (currentPage + 1) % pages.length;
                goToPage(pages[currentPage]);
            }, intervalMs);
        }

        function stopAutoRotate() {
            if (timer) clearInterval(timer);
        }

        // Inicia la rotación automática al cargar la página
        window.onload = function() {
            startAutoRotate(15000); // Cambia cada 15 segundos
        };
    </script>

</body>
</html>